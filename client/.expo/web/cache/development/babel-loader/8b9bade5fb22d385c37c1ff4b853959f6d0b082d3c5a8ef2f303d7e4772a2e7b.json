{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { getAllUsr, getUsrByID, getUsrByName, gamesUsr, updateUsr, usrMsgErr, setUserLogging } from \"./usersSlices\";\nimport axios from \"axios\";\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nexport var getUserByID = function getUserByID(id) {\n  return function () {\n    var _ref = _asyncToGenerator(function* (dispatch) {\n      try {\n        var response = yield axios.get(\"https://gameshop-production-e844.up.railway.app/user/\" + id);\n        var dataUser = response.data;\n        if (dataUser) {\n          dispatch(getUsrByID(dataUser));\n        } else {\n          dispatch(usrMsgErr(\"No user registration\"));\n        }\n      } catch (err) {\n        console.log(\"Error: \" + err);\n        dispatch(usrMsgErr(err));\n      }\n    });\n    return function (_x) {\n      return _ref.apply(this, arguments);\n    };\n  }();\n};\nexport var getUserByName = function getUserByName(name) {\n  return function () {\n    var _ref2 = _asyncToGenerator(function* (dispatch) {\n      try {\n        var response = yield axios.get(\"https://gameshop-production-e844.up.railway.app/user?user=\" + name);\n        var dataUser = response.data;\n        if (dataUser) {\n          dispatch(getUsrByName(dataUser));\n        } else {\n          dispatch(usrMsgErr(\"No user registration\"));\n        }\n      } catch (err) {\n        console.log(\"Error: \" + err);\n        dispatch(usrMsgErr(err));\n      }\n    });\n    return function (_x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n};\nexport var getAllUsers = function () {\n  var _ref3 = _asyncToGenerator(function* () {\n    return function () {\n      var _ref4 = _asyncToGenerator(function* (dispatch) {\n        try {\n          var data = yield axios.get(\"https://gameshop-production-e844.up.railway.app/user\");\n          var dataUsers = data.data;\n          dataUsers ? dispatch(getAllUsr(dataUsers)) : dispatch(usrMsgErr(\"No user registration\"));\n        } catch (err) {\n          console.log(\"Error: \" + err);\n          dispatch(usrMsgErr(err));\n        }\n      });\n      return function (_x3) {\n        return _ref4.apply(this, arguments);\n      };\n    }();\n  });\n  return function getAllUsers() {\n    return _ref3.apply(this, arguments);\n  };\n}();\nexport var updateUser = function () {\n  var _ref5 = _asyncToGenerator(function* (newData) {\n    var oldData = _objectSpread({}, newData);\n    try {\n      var response = yield axios.put('https://gameshop-production-e844.up.railway.app/user/update', newData);\n      var changedFields = [];\n      console.log(response);\n      for (var key in newData) {\n        if (oldData[key] !== response.data[key]) {\n          changedFields.push(key);\n        }\n      }\n      if (changedFields.length > 0) {\n        var storedData = yield AsyncStorage.getItem('loggedGameShop');\n        if (storedData !== null) {\n          var parsedData = JSON.parse(storedData);\n          var updatedData = _objectSpread({}, parsedData);\n          console.log(changedFields);\n          for (var field of changedFields) {\n            updatedData[field] = response.data[field];\n          }\n          var message = \"Was modified: \";\n          for (var _field of changedFields) {\n            message += _field + \": \" + oldData[_field] + \" -> \" + response.data[_field] + \", \";\n          }\n          message = message.slice(0, -2);\n          yield AsyncStorage.setItem('loggedGameShop', JSON.stringify(updatedData));\n          Alert.alert(message);\n        }\n      }\n    } catch (error) {\n      Alert.alert(\"Something went wrong\", \"error updating data\");\n      console.log(\"error updating data\", err);\n    }\n  });\n  return function updateUser(_x4) {\n    return _ref5.apply(this, arguments);\n  };\n}();","map":{"version":3,"names":["getAllUsr","getUsrByID","getUsrByName","gamesUsr","updateUsr","usrMsgErr","setUserLogging","axios","AsyncStorage","getUserByID","id","_ref","_asyncToGenerator","dispatch","response","get","dataUser","data","err","console","log","_x","apply","arguments","getUserByName","name","_ref2","_x2","getAllUsers","_ref3","_ref4","dataUsers","_x3","updateUser","_ref5","newData","oldData","_objectSpread","put","changedFields","key","push","length","storedData","getItem","parsedData","JSON","parse","updatedData","field","message","slice","setItem","stringify","Alert","alert","error","_x4"],"sources":["C:/Users/famil/OneDrive/Escritorio/Henry-PF/GameShop/client/src/redux/userActions.js"],"sourcesContent":["import { Alert } from \"react-native\";\r\nimport {\r\n  getAllUsr,\r\n  getUsrByID,\r\n  getUsrByName,\r\n  gamesUsr,\r\n  updateUsr,\r\n  usrMsgErr,\r\n  setUserLogging,\r\n} from \"./usersSlices\";\r\nimport axios from \"axios\";\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\n\r\n\r\nexport const getUserByID = (id) => {\r\n    return async (dispatch) => {\r\n      try {\r\n        const response = await axios.get(\r\n          `https://gameshop-production-e844.up.railway.app/user/${id}`\r\n        );\r\n  \r\n        const dataUser = response.data;\r\n  \r\n        if (dataUser) {\r\n          dispatch(getUsrByID(dataUser));\r\n        } else {\r\n          dispatch(usrMsgErr(\"No user registration\"));\r\n        }\r\n      } catch (err) {\r\n        console.log(`Error: ${err}`);\r\n        dispatch(usrMsgErr(err));\r\n      }\r\n    };\r\n  };\r\n\r\n  export const getUserByName = (name) => {\r\n    return async (dispatch) => {\r\n      try {\r\n        const response = await axios.get(\r\n          `https://gameshop-production-e844.up.railway.app/user?user=${name}`\r\n        );\r\n  \r\n        const dataUser = response.data;\r\n  \r\n        if (dataUser) {\r\n          dispatch(getUsrByName(dataUser));\r\n        } else {\r\n          dispatch(usrMsgErr(\"No user registration\"));\r\n        }\r\n      } catch (err) {\r\n        console.log(`Error: ${err}`);\r\n        dispatch(usrMsgErr(err));\r\n      }\r\n    };\r\n  };\r\n\r\n  export const getAllUsers = async () => {\r\n    return async (dispatch) => {\r\n      try {\r\n        const data = await axios.get(\r\n          `https://gameshop-production-e844.up.railway.app/user`\r\n        );\r\n  \r\n        const dataUsers = data.data;\r\n  \r\n        dataUsers\r\n          ? dispatch(getAllUsr(dataUsers))\r\n          : dispatch(usrMsgErr(\"No user registration\"));\r\n      } catch (err) {\r\n        console.log(`Error: ${err}`);\r\n  \r\n        dispatch(usrMsgErr(err));\r\n      }\r\n    };\r\n  };\r\n\r\n\r\n\r\n  export const updateUser = async (newData) => {\r\n    const oldData = { ...newData };\r\n    try {\r\n      const response = await axios.put(\r\n        'https://gameshop-production-e844.up.railway.app/user/update',\r\n        newData\r\n      );\r\n  \r\n      const changedFields = [];\r\n      console.log(response);\r\n      for (const key in newData) {\r\n        if (oldData[key] !== response.data[key]) {\r\n          changedFields.push(key);\r\n        }\r\n      }\r\n  \r\n      if (changedFields.length > 0) {\r\n        // ObtÃ©n los datos existentes del AsyncStorage\r\n        const storedData = await AsyncStorage.getItem('loggedGameShop');\r\n        if (storedData !== null) {\r\n          const parsedData = JSON.parse(storedData);\r\n          const updatedData = { ...parsedData };\r\n  \r\n          console.log(changedFields)\r\n          // Actualiza las propiedades modificadas en el AsyncStorage\r\n          for (const field of changedFields) {\r\n            updatedData[field] = response.data[field];\r\n          }\r\n\r\n          let message = \"Was modified: \";\r\n          for (const field of changedFields) {\r\n            message += `${field}: ${oldData[field]} -> ${response.data[field]}, `;\r\n          }\r\n          message = message.slice(0, -2); // Eliminar la coma y el espacio al final\r\n  \r\n          // Guarda los datos actualizados en el AsyncStorage\r\n          await AsyncStorage.setItem('loggedGameShop', JSON.stringify(updatedData));\r\n\r\n          Alert.alert(message)\r\n        }\r\n      }\r\n    } catch (error) {\r\n      Alert.alert(\"Something went wrong\", \"error updating data\");\r\n      console.log(\"error updating data\", err);\r\n    }\r\n  };\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}