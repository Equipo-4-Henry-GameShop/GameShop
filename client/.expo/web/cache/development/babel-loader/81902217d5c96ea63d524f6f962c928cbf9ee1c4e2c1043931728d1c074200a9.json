{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport React from 'react';\nimport Button from \"react-native-web/dist/exports/Button\";\nimport XLSX from 'xlsx';\nimport * as FileSystem from 'expo-file-system';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar ExcelGenerator = function ExcelGenerator(_ref) {\n  var data = _ref.data,\n    fileName = _ref.fileName;\n  var handleGenerateExcel = function () {\n    var _ref2 = _asyncToGenerator(function* () {});\n    return function handleGenerateExcel() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return _jsx(Button, {\n    title: \"Generar Excel\",\n    onPress: handleGenerateExcel\n  });\n};\nexport default ExcelGenerator;","map":{"version":3,"names":["React","Button","XLSX","FileSystem","jsx","_jsx","ExcelGenerator","_ref","data","fileName","handleGenerateExcel","_ref2","_asyncToGenerator","apply","arguments","title","onPress"],"sources":["C:/Users/famil/OneDrive/Escritorio/Henry-PF/GameShop/client/src/components/helpers/ExcelGenerate.jsx"],"sourcesContent":["import React from 'react';\r\nimport { Button } from 'react-native';\r\nimport XLSX from 'xlsx';\r\nimport * as FileSystem from 'expo-file-system';\r\n\r\nconst ExcelGenerator = ({ data, fileName }) => {\r\n  const handleGenerateExcel = async () => {\r\n  //   try {\r\n  //     // Convertir los datos a formato CSV\r\n  //     const csvData = convertToCSV(data);\r\n\r\n  //     // Crear un archivo CSV temporal\r\n  //     const csvFilePath = `${FileSystem.documentDirectory}${fileName}.csv`;\r\n  //     await FileSystem.writeAsStringAsync(csvFilePath, csvData, { encoding: FileSystem.EncodingType.UTF8 });\r\n\r\n  //     // Convertir el archivo CSV a XLSX\r\n  //     const xlsxFilePath = `${FileSystem.documentDirectory}${fileName}.xlsx`;\r\n  //     await convertCSVToXLSX(csvFilePath, xlsxFilePath);\r\n\r\n  //     // Descargar el archivo XLSX\r\n  //     await FileSystem.downloadAsync(xlsxFilePath, `${FileSystem.documentDirectory}${fileName}.xlsx`);\r\n\r\n  //     // Eliminar los archivos temporales\r\n  //     await FileSystem.deleteAsync(csvFilePath);\r\n  //     await FileSystem.deleteAsync(xlsxFilePath);\r\n  //   } catch (error) {\r\n  //     console.log('Error:', error);\r\n  //   }\r\n  // };\r\n\r\n  // const convertToCSV = (data) => {\r\n  //   const header = Object.keys(data[0]).join(',') + '\\n';\r\n  //   const rows = data.map((item) => Object.values(item).join(',')).join('\\n');\r\n  //   return header + rows;\r\n  // };\r\n\r\n  // const convertCSVToXLSX = async (csvFilePath, xlsxFilePath) => {\r\n  //   const fileContent = await FileSystem.readAsStringAsync(csvFilePath);\r\n  //   const workbook = XLSX.utils.book_new();\r\n  //   const worksheet = XLSX.utils.sheet_add_json(XLSX.utils.json_from_csv(fileContent), { header: 1 });\r\n  //   XLSX.utils.book_append_sheet(workbook, worksheet, 'Sheet1');\r\n  //   const excelBuffer = XLSX.write(workbook, { type: 'base64' });\r\n  //   await FileSystem.writeAsStringAsync(xlsxFilePath, excelBuffer, { encoding: FileSystem.EncodingType.Base64 });\r\n  };\r\n\r\n  return (\r\n    <Button title=\"Generar Excel\" onPress={handleGenerateExcel} />\r\n  );\r\n};\r\n\r\nexport default ExcelGenerator;"],"mappings":";AAAA,OAAOA,KAAK,MAAM,OAAO;AAAC,OAAAC,MAAA;AAE1B,OAAOC,IAAI,MAAM,MAAM;AACvB,OAAO,KAAKC,UAAU,MAAM,kBAAkB;AAAC,SAAAC,GAAA,IAAAC,IAAA;AAE/C,IAAMC,cAAc,GAAG,SAAjBA,cAAcA,CAAAC,IAAA,EAA2B;EAAA,IAArBC,IAAI,GAAAD,IAAA,CAAJC,IAAI;IAAEC,QAAQ,GAAAF,IAAA,CAARE,QAAQ;EACtC,IAAMC,mBAAmB;IAAA,IAAAC,KAAA,GAAAC,iBAAA,CAAG,aAAY,CAqCxC,CAAC;IAAA,gBArCKF,mBAAmBA,CAAA;MAAA,OAAAC,KAAA,CAAAE,KAAA,OAAAC,SAAA;IAAA;EAAA,GAqCxB;EAED,OACET,IAAA,CAACJ,MAAM;IAACc,KAAK,EAAC,eAAe;IAACC,OAAO,EAAEN;EAAoB,CAAE,CAAC;AAElE,CAAC;AAED,eAAeJ,cAAc"},"metadata":{},"sourceType":"module","externalDependencies":[]}